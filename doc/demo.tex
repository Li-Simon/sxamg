\chapter{How to Use}

\section{Solver}

This example shows how to use SXAMG as a solver.

\begin{evb}
{
    SX_AMG_PARS pars;
    SX_MAT A;
    SX_VEC b, x;
    int verb = 2;
    SX_RTN rtn;
    
    /* default pars */
    sx_amg_pars_init(&pars);

    /* redefine parameters */
    pars.maxit = 1000;
    pars.verb = 2;
    
    /* set A, b, initial x */
    ....
    
    /* solve the system */
    rtn = sx_solver_amg(&A, &x, &b, &pars);
    
    /* free memory */
    sx_mat_destroy(&A);
    sx_vec_destroy(&b);
    sx_vec_destroy(&x);
}
\end{evb}

We can see that only two functions are called: 1) \nverb{sx_amg_pars_init} initializes default AMG
parameters; 2) \nverb{sx_solver_amg} setups, solves and destroys the AMG system, and the solution
is stored by \nverb{x}.

The user needs to provide, matrix, right-hand side and initial guess.

\section{Lower Level Interface}

This example exposes more details of the AMG solver: 1) setup; 2) solve; 3) destroy.

\begin{evb}
{
    SX_AMG_PARS pars;
    SX_MAT A;
    SX_VEC b, x;
    int verb = 2;
    SX_AMG *mg;
    SX_RTN rtn;
    
    /* pars */
    sx_amg_pars_init(&pars);
    pars.maxit = 1000;
    pars.verb = 2;
    
    /* input A */
    ....

    // Step 1: AMG setup phase
    mg = sx_amg_setup(&A, &pars);

    // Step 2: AMG solve phase
    /* rhs and initial guess */
    x = sx_vec_create(A.num_rows);
    sx_vec_set_value(&x, 1.0);

    b = sx_vec_create(A.num_rows);
    sx_vec_set_value(&b, 1.0);

    /* solve */
    rtn = sx_solver_amg_solve(mg, &x, &b);

    sx_mat_destroy(&A);
    sx_vec_destroy(&b);
    sx_vec_destroy(&x);
    sx_amg_data_destroy(&mg);
}
\end{evb}

The user can modify this example to use SXAMG as a preconditioner, where the AMG system is assembled
once and other solvers can call solving phase in each iteration.

